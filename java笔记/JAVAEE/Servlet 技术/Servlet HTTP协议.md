[TOC]

# HTTP 协议详解

## 简述

互联网的发展非常迅速，但是万变不离其宗。学习 web 开发，需要我们对互联的交互机制有一定的了解。为了更好的理解并掌握Servlet，在正式学习 Servlet
之前需要对 web 开发中客户端和服务器的交互机制以及所涉及的规范(HTTP)进
行学习。 

## web交互得基本流程

![1566563787475](https://raw.githubusercontent.com/jssda/picbed/master/1566563787475.png)

客户端根据用户输入的地址信息请求服务器，服务器在接收到用户
的请求后进行处理，然后将处理结果响应给客户端，客户端将响应结果展
示给用户。 

请求: 客户端根据用户地址信息将数据发送给服务器的过程 

相应: 服务器将请求的处理结果发送给浏览器的过程 

## HTTP概念和介绍

web交互的流程无非就是客户端向服务器发送请求, 服务器相应请求. 但是, 这个传输过程当中, 他们遵循什么样的格式呢? 怎么识别相互的传输数据呢? 此时HTTP协议出现了

### 概念

HTTP: 超文本传输协议（Hyper Text Transfer Protocol） 

### 作用

规范了浏览器和服务器的数据交互 

### 特点

1. 简单快速

   客户向服务器请求服务时，只需传送请求方法和路径。
   请求方法常用的有 GET、 HEAD、 POST。每种方法规定了客户与服
   务器联系的类型不同。由于 HTTP 协议简单，使得 HTTP 服务器的
   程序规模小，因而通信速度很快 

2. 灵活

   HTTP 允许传输任意类型的数据对象。正在传输的类型由
   Content-Type 加以标记。 

3. 无连接 

   无连接的含义是限制每次连接只处理一个请求。服务器
   处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方
   式可以节省传输时间 

4. 无状态

   HTTP 协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，
   在服务器不需要先前信息时它的应答就较快。也就是说, HTTP协议不会记录传输数据.

5. 支持B/S及C/S模式

6. HTTP1.1 版本之后支持可持续连接

## HTTP的交互流程

HTTP的交互流程分为四个步骤(一次完整的请求)

1. 客户端和服务器建立连接
2. 客户端发送请求到服务器端(HTTP协议)
3. 服务器接受到请求后, 进行处理, 然后将处理结果相应客户端(HTTP协议)
4. 关闭客户端和服务器端的连接(HTTP1.1 后不会立即关闭, 延迟关闭)

## HTTP协议的请求格式

### 请求格式的结构

- 请求行: 请求方式、请求的地址和 HTTP 协议版本 
- 请求头: 消息报头，一般用来说明客户端要使用的一些附加信息 
- 空行: 位于请求行和请求数据之间，空行是必须的 
- 请求数据: 非必须

![1566565701533](https://raw.githubusercontent.com/jssda/picbed/master/1566565701533.png)

注意: 一张网页的内容是极其丰富的，浏览器会遵循
HTTP 请求的格式将有效数据发送给服务器。 

### get请求

![1566565744785](https://raw.githubusercontent.com/jssda/picbed/master/1566565744785.png)

### post请求

![1566565753311](https://raw.githubusercontent.com/jssda/picbed/master/1566565753311.png)

## HTTP协议之请求方式

根据HTTP标准, HTTP请求可以使用多种请求方法

HTTP1.0 定义了三种请求方法: GET, POST 和 HEAD方法

HTTP1.1 新增了五种请求方法: OPTIONS, PUT, DELETE, TRACE和CONNECT方法

![1566565862823](https://raw.githubusercontent.com/jssda/picbed/master/1566565862823.png)

### GET和POST请求方法的区别

#### GET请求方法

请求数据会以？的形式隔开拼接在请求头中， 不安全， 没有请求实体部分 

HTTP 协议虽然没有规定请求数据的大小，但是浏览器对 URL 的长度
是有限制的，所以 get 请求不能携带大量的数据。 

#### POST请求方法

请求数据在请求实体中进行发送，在 URL 中看不到具体的请求数据，
安全。 适合数据量大的数据发送。 

## HTTP协议之响应格式

### 响应格式的结构

- 响应行(状态行)： HTTP 版本、状态码、状态消息 
- 响应头： 消息报头，客户端使用的附加信息 
- 空行： 响应头和响应实体之间的，必须的。 
- 响应实体： 正文，服务器返回给浏览器的信息 

![1566566089624](https://raw.githubusercontent.com/jssda/picbed/master/1566566089624.png)

## HTTP协议之响应状态

HTTP 状态码由三个十进制数字组成，第一个十进制数字定义了状态码的
类型，后两个数字没有分类的作用。 HTTP 状态码共分为 5 种类型： 

![1566566126594](https://raw.githubusercontent.com/jssda/picbed/master/1566566126594.png)

### 常用状态码

```java
200 OK //客户端请求成功
400 Bad Request //客户端请求有语法错误，不能被服务器所
理解
401 Unauthorized //请求未经授权，这个状态代码必须和 WWWAuthenticate 报头域一起使用
403 Forbidden //服务器收到请求，但是拒绝提供服务
404 Not Found //请求资源不存在， eg：输入了错误的 URL
500 Internal Server Error //服务器发生不可预期的错误
503 Server Unavailable //服务器当前不能处理客户端的请求，一段时间后可能恢复正常
```

